/**
 * angular-strap
 * @version v2.2.0 - 2015-03-31
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes (olivier@mg-crea.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("mgcrea.ngStrap.select",["mgcrea.ngStrap.tooltip","mgcrea.ngStrap.helpers.parseOptions"]).filter("startsWithLetter",function(){return function(e,t,n){for(var a=[],l=new RegExp(n,"i"),i=0;i<e.length;i++){var o=e[i];l.test(o[t].substring(0,1))&&a.push(o)}return a}}).provider("$select",function(){var e=this.defaults={animation:"am-fade",prefixClass:"select",prefixEvent:"$select",placement:"bottom-left",template:"select/select.tpl.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,multiple:!1,allNoneButtons:!1,sort:!0,caretHtml:'&nbsp;<span class="caret"></span>',placeholder:"Choose among the following...",allText:"All",noneText:"None",maxLength:3,maxLengthHtml:"selected",iconCheckmark:"glyphicon glyphicon-ok"};this.$get=["$window","$document","$rootScope","$tooltip","$timeout","$filter",function(t,n,a,l,i,o){function r(t,n,a){var r={},c=angular.extend({},e,a);c.sort=c.sort.toString().match(/true|1/i),r=l(t,c);var u=r.$scope;u.$matches=[],u.$activeIndex=0,u.$isMultiple=c.multiple,u.$showAllNoneButtons=c.allNoneButtons&&c.multiple,u.$iconCheckmark=c.iconCheckmark,u.$allText=c.allText,u.$noneText=c.noneText,u.$activate=function(e){u.$$postDigest(function(){r.activate(e)})},u.$select=function(e){u.$$postDigest(function(){r.select(e)})},u.$isVisible=function(){return r.$isVisible()},u.$isActive=function(e){return r.$isActive(e)},u.$selectAll=function(){for(var e=0;e<u.$matches.length;e++)u.$isActive(e)||u.$select(e)},u.$selectNone=function(){for(var e=0;e<u.$matches.length;e++)u.$isActive(e)&&u.$select(e)},r.update=function(e){u.$matches=e,r.$updateActiveIndex()},r.activate=function(e){return c.multiple?(r.$isActive(e)?u.$activeIndex.splice(u.$activeIndex.indexOf(e),1):u.$activeIndex.push(e),c.sort&&u.$activeIndex.sort()):u.$activeIndex=e,u.$activeIndex},r.select=function(e){var t=u.$matches[e].value;u.$apply(function(){r.activate(e),c.multiple?n.$setViewValue(u.$activeIndex.map(function(e){return u.$matches[e].value})):(n.$setViewValue(t),r.hide())}),u.$emit(c.prefixEvent+".select",t,e,r)},r.$updateActiveIndex=function(){n.$modelValue&&u.$matches.length?u.$activeIndex=c.multiple&&angular.isArray(n.$modelValue)?n.$modelValue.map(function(e){return r.$getIndex(e)}):r.$getIndex(n.$modelValue):u.$activeIndex>=u.$matches.length&&(u.$activeIndex=c.multiple?[]:0)},r.$isVisible=function(){return c.minLength&&n?u.$matches.length&&n.$viewValue.length>=c.minLength:u.$matches.length},r.$isActive=function(e){return c.multiple?-1!==u.$activeIndex.indexOf(e):u.$activeIndex===e},r.$getIndex=function(e){var t=u.$matches.length,n=t;if(t){for(n=t;n--&&u.$matches[n].value!==e;);if(!(0>n))return n}},r.$onMouseDown=function(e){if(e.preventDefault(),e.stopPropagation(),s){var t=angular.element(e.target);t.triggerHandler("click")}},r.$onKeyDown=function(e){var t=[9,13,38,40];if(t.indexOf(e.keyCode)<0){var n=o("startsWithLetter")(u.$matches,"label",String.fromCharCode(e.keyCode));n.length>0&&(u.$activeIndex=n[0].index)}else{if(e.preventDefault(),e.stopPropagation(),!c.multiple&&(13===e.keyCode||9===e.keyCode))return r.select(u.$activeIndex);38===e.keyCode&&u.$activeIndex>0?u.$activeIndex--:40===e.keyCode&&u.$activeIndex<u.$matches.length-1?u.$activeIndex++:angular.isUndefined(u.$activeIndex)&&(u.$activeIndex=0)}var a=r.$element.find("li.active");r.$element[0].scrollTop=u.$activeIndex*a.height(),u.$digest()};var $=r.show;r.show=function(){$(),c.multiple&&r.$element.addClass("select-multiple"),i(function(){r.$element.on(s?"touchstart":"mousedown",r.$onMouseDown),c.keyboard&&t.on("keydown",r.$onKeyDown)},0,!1)};var d=r.hide;return r.hide=function(){r.$element.off(s?"touchstart":"mousedown",r.$onMouseDown),c.keyboard&&t.off("keydown",r.$onKeyDown),d(!0)},r}var c=(angular.element(t.document.body),/(ip(a|o)d|iphone|android)/gi.test(t.navigator.userAgent)),s="createTouch"in t.document&&c;return r.defaults=e,r}]}).directive("bsSelect",["$window","$parse","$q","$select","$parseOptions",function(e,t,n,a,l){var i=a.defaults;return{restrict:"EAC",require:"ngModel",link:function(e,t,n,o){var r={scope:e,placeholder:i.placeholder};if(angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","placeholder","multiple","allNoneButtons","maxLength","maxLengthHtml","allText","noneText","iconCheckmark","autoClose","id","sort","caretHtml"],function(e){angular.isDefined(n[e])&&(r[e]=n[e])}),"select"===t[0].nodeName.toLowerCase()){var c=t;c.css("display","none"),t=angular.element('<button type="button" class="btn btn-default"></button>'),c.after(t)}var s=l(n.ngOptions),u=a(t,o,r),$=s.$match[7].replace(/\|.+/,"").trim();e.$watch($,function(){s.valuesFn(e,o).then(function(e){u.update(e),o.$render()})},!0),e.$watch(n.ngModel,function(){u.$updateActiveIndex(),o.$render()},!0),o.$render=function(){var e,n;r.multiple&&angular.isArray(o.$modelValue)?(e=o.$modelValue.map(function(e){return n=u.$getIndex(e),angular.isDefined(n)?u.$scope.$matches[n].label:!1}).filter(angular.isDefined),e=e.length>(r.maxLength||i.maxLength)?e.length+" "+(r.maxLengthHtml||i.maxLengthHtml):e.join(", ")):(n=u.$getIndex(o.$modelValue),e=angular.isDefined(n)?u.$scope.$matches[n].label:!1),t.html((e?e:r.placeholder)+(r.caretHtml?r.caretHtml:i.caretHtml))},r.multiple&&(o.$isEmpty=function(e){return!e||0===e.length}),e.$on("$destroy",function(){u&&u.destroy(),r=null,u=null})}}}]);
//# sourceMappingURL=select.min.js.map